---
sidebar: sidebar 
permalink: use/manage-apps.html 
keywords: manage app, discover app, ignore app 
summary: '将 Kubernetes 集群添加到 Astra Control 后，您可以在该集群上安装应用程序（在 Astra Control 之外），然后转到 Astra Control 中的 "Apps" 页面开始管理这些应用程序。' 
---
= 开始管理应用程序
:hardbreaks:
:allow-uri-read: 
:icons: font
:imagesdir: ../media/use/


你先请 link:../get-started/add-first-cluster.html["将 Kubernetes 集群添加到 Astra Control"]，您可以在集群上安装应用程序（在 Astra Control 之外），然后转到 Astra Control 中的应用程序页面开始管理这些应用程序。



== 应用程序管理要求

Astra Control 具有以下应用程序管理要求：

* * 许可 * ：要使用 Astra 控制中心管理应用程序，您需要获得 Astra 控制中心许可证。
* * 命名空间 * ： Astra Control 要求一个应用程序不能跨越多个命名空间，但一个命名空间可以包含多个应用程序。
* * 存储类 * ：如果您安装的应用程序明确设置了 StorageClass ，并且需要克隆该应用程序，则克隆操作的目标集群必须具有最初指定的 StorageClass 。将显式设置了 StorageClass 的应用程序克隆到不具有相同 StorageClass 的集群将失败。
* * Kubernetes Resources* ：使用非 Astra Control 收集的 Kubernetes 资源的应用程序可能没有完整的应用程序数据管理功能。Astra Control 收集以下 Kubernetes 资源：


[cols="1,1,1"]
|===


| ClusterRole | ClusterRoleBinding. | 配置映射 


| 自定义资源定义 | 自定义资源 | cronjob 


| DemonSet | HorizontalPodAutoscaler | 传入 


| DeploymentConfig | MutatingWebhook | PersistentVolumeClaim 


| POD | PodDisruptionBuget | 播客模板 


| 网络策略 | ReplicaSet | Role 


| RoleBinding. | 路由 | 机密 


| 服务 | ServiceAccount | 状态集 


| 验证 Webhook |  |  
|===


=== 支持的应用程序安装方法

您可以使用以下方法安装要使用 Astra Control 管理的应用程序：

* * 清单文件 * ： Astra Control 支持使用 kubectl 从清单文件安装的应用程序。例如：
+
[source, sh]
----
kubectl apply -f myapp.yaml
----
* * Helm 3* ：如果使用 Helm 安装应用程序，则 Astra Control 需要 Helm 版本 3 。完全支持管理和克隆随 Helm 3 安装的应用程序（或从 Helm 2 升级到 Helm 3 ）。不支持管理随 Helm 2 安装的应用程序。
* *操作员部署的应用程序*：Astra Control支持使用命名空间范围的操作员安装的应用程序、这些应用程序通常采用"按价值传递"而不是"按参考传递"架构设计。操作员及其安装的应用程序必须使用相同的命名空间；您可能需要为操作员修改部署 .yaml 文件，以确保情况确实如此。
+
以下是一些遵循这些模式的操作员应用程序：

+
** https://github.com/k8ssandra/cass-operator/tree/v1.7.1["Apache K8ssandra"^]
+

NOTE: 对于 K8ssandra ，支持原位还原操作。要对新命名空间或集群执行还原操作，需要关闭应用程序的原始实例。这是为了确保传输的对等组信息不会导致跨实例通信。不支持克隆应用程序。

** https://github.com/jenkinsci/kubernetes-operator["Jenkins CI"^]
** https://github.com/percona/percona-xtradb-cluster-operator["Percona XtraDB 集群"^]




Astra Control可能无法克隆使用"按参考传递"架构设计的运算符(例如CockroachDB运算符)。在这些类型的克隆操作期间，克隆的操作员会尝试引用源操作员提供的 Kubernetes 机密，尽管在克隆过程中他们拥有自己的新机密。克隆操作可能会失败，因为 Astra Control 不知道源运算符中的 Kubernetes 密钥。



== 在集群上安装应用程序

你先请 link:../get-started/add-first-cluster.html["已添加集群"] 对于Astra Control、您可以在集群上安装应用程序或管理现有应用程序。可以管理范围仅限于单个命名空间的任何应用程序。

只有当存储位于由 Astra Control 安装的存储类上时， Astra Control 才会管理有状态应用程序。

ifdef::gcp[]

* link:../learn/choose-class-and-size.html["了解 GKEE 集群的存储类"]


endif::gcp[]

ifdef::azure[]

* link:../learn/azure-storage.html["了解 AKS 集群的存储类"]


endif::azure[]

ifdef::aws[]

* link:../learn/aws-storage.html["了解AWS集群的存储类"]


endif::aws[]



== 管理应用程序

在Astra Control发现集群上的命名空间后、您可以定义要管理的应用程序。您可以选择 link:../learn/app-management.html["将整个命名空间作为一个应用程序进行管理、或者单独管理命名空间中的一个或多个应用程序"]。这一切都可以细化到数据保护操作所需的粒度级别。

虽然您可以使用Astra Control单独管理层次结构的两个级别(命名空间和该命名空间中的应用程序)、但最佳做法是选择一个或另一个。如果在命名空间和应用程序级别同时执行操作，则在 Astra Control 中执行的操作可能会失败。


TIP: 例如、您可能希望为"Maria"设置一个每周节奏的备份策略、但您可能需要比该策略更频繁地备份"MariaDB"(位于同一命名空间中)。根据这些需求、您需要单独管理这些应用程序、而不是作为单命名空间应用程序来管理。

.您需要什么？ #8217 ；将需要什么
* 已将Kubernetes集群添加到Astra Control中。
* 集群上安装的一个或多个应用程序。  app installation methods,阅读有关支持的应用程序安装方法的更多信息。
* 一个或多个活动Pod。
* 在已添加到Astra Control的Kubernetes集群上指定的命名空间。
* (可选)任何上的Kubernetes标签 link:../use/manage-apps.html#app-management-requirements["支持的Kubernetes资源"]。
+

TIP: 标签是一个键 / 值对，您可以将其分配给 Kubernetes 对象进行标识。通过标签，可以更轻松地对 Kubernetes 对象进行排序，组织和查找。要了解有关 Kubernetes 标签的更多信息， https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/["请参见 Kubernetes 官方文档"^]。



开始之前、您还应了解相关信息 link:../use/manage-apps.html#what-about-system-namespaces["管理标准命名空间和系统命名空间"]。有关如何使用 Astra Control API 管理应用程序的说明，请参见 link:https://docs.netapp.com/us-en/astra-automation/["Astra Automation 和 API 信息"^]。

.应用程序管理选项
*  resources to manage as an app
*  a namespace to manage as an app




=== 定义要作为应用程序进行管理的资源

您可以指定 link:../learn/app-management.html["构成应用程序的Kubernetes资源"] 要使用Astra Control进行管理的。通过定义应用程序、您可以将Kubernetes集群中的元素分组到一个应用程序中。此Kubernetes资源集合按命名空间和标签选择器标准进行组织。

通过定义应用程序、您可以更精细地控制要包含在Astra Control操作中的内容、包括克隆、快照和备份。


WARNING: 定义应用程序时、请确保不在具有保护策略的多个应用程序中包含Kubernetes资源。Kubernetes资源上重叠的保护策略可能会发生发生原因 数据冲突。

.步骤
. 从应用程序页面中、选择*定义*。
. 在*定义应用程序*窗口中、输入应用程序名称。
. 在*集群*下拉列表中选择运行应用程序的集群。
. 从*命名空间*下拉列表中选择应用程序的命名空间。
+

NOTE: 只能在单个集群上的指定命名空间中定义应用程序。Astra Control不支持应用程序跨越多个命名空间或集群。

. 输入应用程序和命名空间的标签。您可以指定单个标签或标签选择器条件(查询)。
+

TIP: 要了解有关 Kubernetes 标签的更多信息， https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/["请参见 Kubernetes 官方文档"^]。

. 选择*定义*后、根据需要对其他应用程序重复此过程。


定义完应用程序后、该应用程序将显示在应用程序页面上的应用程序列表中。现在、您可以克隆它并创建备份和快照。


NOTE: 您刚刚添加的应用程序在 " 受保护 " 列下可能会显示一个警告图标，表示它尚未备份，并且尚未计划备份。


TIP: 要查看特定应用程序的详细信息，请选择应用程序名称。



=== 定义要作为应用程序进行管理的命名空间

您可以通过将命名空间的资源定义为应用程序来将命名空间中的所有Kubernetes资源添加到Astra Control管理中。如果您要以类似的方式并以通用间隔管理和保护特定命名空间中的所有资源、则此方法比单独定义应用程序更好。

.步骤
. 从集群页面中、选择一个集群。
. 选择*命名空间*选项卡。
. 选择包含要管理的应用程序资源的命名空间的"Actions"菜单、然后选择*定义为应用程序*。
+

TIP: 如果要管理多个命名空间、请选择这些命名空间、然后选择左上角的*操作*按钮并选择*管理*。

+

NOTE: 选中*显示系统命名空间*复选框以显示默认情况下在应用程序管理中不使用的系统命名空间。 image:acc_namespace_system.png["显示命名空间选项卡中提供的*显示系统命名空间*选项的屏幕截图。"] link:../use/manage-apps.html#what-about-system-namespaces["阅读更多内容"]。



此过程完成后、与此命名空间关联的应用程序将显示在`Associated applications`列中。



== 系统命名空间如何？

Astra Control还会发现Kubernetes集群上的系统命名空间。默认情况下、我们不会向您显示这些系统命名空间、因为您很少需要备份系统应用程序资源。

通过选中*显示系统命名空间*复选框、您可以从选定集群的命名空间选项卡中显示系统命名空间。

image:acc_namespace_system.png["显示命名空间选项卡中提供的*显示系统命名空间*选项的屏幕截图。"]


TIP: Astra Control 本身不是一个标准应用程序，而是一个 " 系统应用程序 " 。 您不应尝试管理 Astra Control 本身。默认情况下，用于管理的 Astra Control 本身不会显示。
